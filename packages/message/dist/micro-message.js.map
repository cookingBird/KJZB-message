{"version":3,"file":"micro-message.js","mappings":"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","sources":["webpack://@gislife/micro-message/webpack/universalModuleDefinition","webpack://@gislife/micro-message/./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js","webpack://@gislife/micro-message/./node_modules/style-loader/dist/runtime/insertBySelector.js","webpack://@gislife/micro-message/./node_modules/style-loader/dist/runtime/insertStyleElement.js","webpack://@gislife/micro-message/./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js","webpack://@gislife/micro-message/./node_modules/style-loader/dist/runtime/styleDomAPI.js","webpack://@gislife/micro-message/./node_modules/style-loader/dist/runtime/styleTagTransform.js","webpack://@gislife/micro-message/webpack/bootstrap","webpack://@gislife/micro-message/webpack/runtime/compat get default export","webpack://@gislife/micro-message/webpack/runtime/define property getters","webpack://@gislife/micro-message/webpack/runtime/hasOwnProperty shorthand","webpack://@gislife/micro-message/webpack/runtime/make namespace object","webpack://@gislife/micro-message/webpack/runtime/nonce","webpack://@gislife/micro-message/./src/util/onEvent.js","webpack://@gislife/micro-message/./src/util/requestDom.js","webpack://@gislife/micro-message/./src/util/volume.js","webpack://@gislife/micro-message/./src/util/getParams.js","webpack://@gislife/micro-message/./src/util/validator.js","webpack://@gislife/micro-message/./src/util/index.js","webpack://@gislife/micro-message/./node_modules/uuid/dist/esm-browser/native.js","webpack://@gislife/micro-message/./node_modules/uuid/dist/esm-browser/rng.js","webpack://@gislife/micro-message/./node_modules/uuid/dist/esm-browser/stringify.js","webpack://@gislife/micro-message/./node_modules/uuid/dist/esm-browser/v4.js","webpack://@gislife/micro-message/./src/core/Message.js","webpack://@gislife/micro-message/./src/core/Channel.js","webpack://@gislife/micro-message/./src/ApplicationChannel.js","webpack://@gislife/micro-message/src/microApp.vue","webpack://@gislife/micro-message/./src/microApp.vue?fb87","webpack://@gislife/micro-message/./src/microApp.vue?f7c4","webpack://@gislife/micro-message/./src/microApp.vue?d935","webpack://@gislife/micro-message/./node_modules/vue-loader/lib/runtime/componentNormalizer.js","webpack://@gislife/micro-message/./src/microApp.vue","webpack://@gislife/micro-message/./src/index.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"micro-message\"] = factory();\n\telse\n\t\troot[\"micro-message\"] = factory();\n})(self, () => {\nreturn ","\"use strict\";\n\nvar stylesInDOM = [];\nfunction getIndexByIdentifier(identifier) {\n  var result = -1;\n  for (var i = 0; i < stylesInDOM.length; i++) {\n    if (stylesInDOM[i].identifier === identifier) {\n      result = i;\n      break;\n    }\n  }\n  return result;\n}\nfunction modulesToDom(list, options) {\n  var idCountMap = {};\n  var identifiers = [];\n  for (var i = 0; i < list.length; i++) {\n    var item = list[i];\n    var id = options.base ? item[0] + options.base : item[0];\n    var count = idCountMap[id] || 0;\n    var identifier = \"\".concat(id, \" \").concat(count);\n    idCountMap[id] = count + 1;\n    var indexByIdentifier = getIndexByIdentifier(identifier);\n    var obj = {\n      css: item[1],\n      media: item[2],\n      sourceMap: item[3],\n      supports: item[4],\n      layer: item[5]\n    };\n    if (indexByIdentifier !== -1) {\n      stylesInDOM[indexByIdentifier].references++;\n      stylesInDOM[indexByIdentifier].updater(obj);\n    } else {\n      var updater = addElementStyle(obj, options);\n      options.byIndex = i;\n      stylesInDOM.splice(i, 0, {\n        identifier: identifier,\n        updater: updater,\n        references: 1\n      });\n    }\n    identifiers.push(identifier);\n  }\n  return identifiers;\n}\nfunction addElementStyle(obj, options) {\n  var api = options.domAPI(options);\n  api.update(obj);\n  var updater = function updater(newObj) {\n    if (newObj) {\n      if (newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap && newObj.supports === obj.supports && newObj.layer === obj.layer) {\n        return;\n      }\n      api.update(obj = newObj);\n    } else {\n      api.remove();\n    }\n  };\n  return updater;\n}\nmodule.exports = function (list, options) {\n  options = options || {};\n  list = list || [];\n  var lastIdentifiers = modulesToDom(list, options);\n  return function update(newList) {\n    newList = newList || [];\n    for (var i = 0; i < lastIdentifiers.length; i++) {\n      var identifier = lastIdentifiers[i];\n      var index = getIndexByIdentifier(identifier);\n      stylesInDOM[index].references--;\n    }\n    var newLastIdentifiers = modulesToDom(newList, options);\n    for (var _i = 0; _i < lastIdentifiers.length; _i++) {\n      var _identifier = lastIdentifiers[_i];\n      var _index = getIndexByIdentifier(_identifier);\n      if (stylesInDOM[_index].references === 0) {\n        stylesInDOM[_index].updater();\n        stylesInDOM.splice(_index, 1);\n      }\n    }\n    lastIdentifiers = newLastIdentifiers;\n  };\n};","\"use strict\";\n\nvar memo = {};\n\n/* istanbul ignore next  */\nfunction getTarget(target) {\n  if (typeof memo[target] === \"undefined\") {\n    var styleTarget = document.querySelector(target);\n\n    // Special case to return head of iframe instead of iframe itself\n    if (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n      try {\n        // This will throw an exception if access to iframe is blocked\n        // due to cross-origin restrictions\n        styleTarget = styleTarget.contentDocument.head;\n      } catch (e) {\n        // istanbul ignore next\n        styleTarget = null;\n      }\n    }\n    memo[target] = styleTarget;\n  }\n  return memo[target];\n}\n\n/* istanbul ignore next  */\nfunction insertBySelector(insert, style) {\n  var target = getTarget(insert);\n  if (!target) {\n    throw new Error(\"Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.\");\n  }\n  target.appendChild(style);\n}\nmodule.exports = insertBySelector;","\"use strict\";\n\n/* istanbul ignore next  */\nfunction insertStyleElement(options) {\n  var element = document.createElement(\"style\");\n  options.setAttributes(element, options.attributes);\n  options.insert(element, options.options);\n  return element;\n}\nmodule.exports = insertStyleElement;","\"use strict\";\n\n/* istanbul ignore next  */\nfunction setAttributesWithoutAttributes(styleElement) {\n  var nonce = typeof __webpack_nonce__ !== \"undefined\" ? __webpack_nonce__ : null;\n  if (nonce) {\n    styleElement.setAttribute(\"nonce\", nonce);\n  }\n}\nmodule.exports = setAttributesWithoutAttributes;","\"use strict\";\n\n/* istanbul ignore next  */\nfunction apply(styleElement, options, obj) {\n  var css = \"\";\n  if (obj.supports) {\n    css += \"@supports (\".concat(obj.supports, \") {\");\n  }\n  if (obj.media) {\n    css += \"@media \".concat(obj.media, \" {\");\n  }\n  var needLayer = typeof obj.layer !== \"undefined\";\n  if (needLayer) {\n    css += \"@layer\".concat(obj.layer.length > 0 ? \" \".concat(obj.layer) : \"\", \" {\");\n  }\n  css += obj.css;\n  if (needLayer) {\n    css += \"}\";\n  }\n  if (obj.media) {\n    css += \"}\";\n  }\n  if (obj.supports) {\n    css += \"}\";\n  }\n  var sourceMap = obj.sourceMap;\n  if (sourceMap && typeof btoa !== \"undefined\") {\n    css += \"\\n/*# sourceMappingURL=data:application/json;base64,\".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))), \" */\");\n  }\n\n  // For old IE\n  /* istanbul ignore if  */\n  options.styleTagTransform(css, styleElement, options.options);\n}\nfunction removeStyleElement(styleElement) {\n  // istanbul ignore if\n  if (styleElement.parentNode === null) {\n    return false;\n  }\n  styleElement.parentNode.removeChild(styleElement);\n}\n\n/* istanbul ignore next  */\nfunction domAPI(options) {\n  if (typeof document === \"undefined\") {\n    return {\n      update: function update() {},\n      remove: function remove() {}\n    };\n  }\n  var styleElement = options.insertStyleElement(options);\n  return {\n    update: function update(obj) {\n      apply(styleElement, options, obj);\n    },\n    remove: function remove() {\n      removeStyleElement(styleElement);\n    }\n  };\n}\nmodule.exports = domAPI;","\"use strict\";\n\n/* istanbul ignore next  */\nfunction styleTagTransform(css, styleElement) {\n  if (styleElement.styleSheet) {\n    styleElement.styleSheet.cssText = css;\n  } else {\n    while (styleElement.firstChild) {\n      styleElement.removeChild(styleElement.firstChild);\n    }\n    styleElement.appendChild(document.createTextNode(css));\n  }\n}\nmodule.exports = styleTagTransform;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.nc = undefined;","import '../core/Channel.type'\r\n/**\r\n * @description 监听pagehide事件\r\n * @param {Function} cb 回调函数\r\n * @returns {Function} 取消回调的函数\r\n */\r\nexport function onPageHide (cb) {\r\n  console.log('page hide-------------------------------')\r\n  window.addEventListener('pagehide', cb)\r\n  return () => window.removeEventListener('pagehide', cb)\r\n}\r\n\r\n/**\r\n * @description 监听load事件\r\n * @param {Function} cb 回调函数\r\n * @returns {Function} 取消回调的函数\r\n */\r\nexport function onLoad (cb) {\r\n  window.addEventListener('load', cb)\r\n  return () => window.removeEventListener('load', cb)\r\n}\r\n\r\n/**\r\n * @description 监听message事件\r\n * @param {IGenericFunction<IMessageEventResponse<*>,*>} cb 回调函数\r\n * @returns {onCallback} 取消回调的函数\r\n */\r\nexport function onMessage (cb) {\r\n  window.addEventListener('message', cb)\r\n  return () => window.removeEventListener('message', cb)\r\n}\r\n","/**\r\n * @callback judgeCallback\r\n * @param {?HTMLIFrameElement}\r\n * @returns {boolean}\r\n */\r\n\r\n/**\r\n *\r\n * @param {string} id 目标元素id\r\n * @param {?judgeCallback} judgeCb 确定元素获取成功的judge函数\r\n * @param {'requestAnimationFrame' | 'setTimeout'} [type='requestAnimationFrame'] 轮询函数类型\r\n * @returns {promise<HTMLIFrameElement | null>}\r\n */\r\nexport function requestDom (\r\n  id,\r\n  judgeCb = el => Boolean(el),\r\n  type = 'requestAnimationFrame'\r\n) {\r\n  function getDom (id, callback, type) {\r\n    if (document && window && window.requestAnimationFrame) {\r\n      const el = document.getElementById(id)\r\n\r\n      if (!judgeCb(el)) {\r\n        if (type === 'requestAnimationFrame') {\r\n          requestAnimationFrame(() => {\r\n            getDom(id, callback, type)\r\n          })\r\n        }\r\n        if (type === 'setTimeout') {\r\n          setTimeout(() => {\r\n            getDom(id, callback, type)\r\n          })\r\n        }\r\n      } else {\r\n        return callback(el)\r\n      }\r\n    } else {\r\n      throw Error(\"browser don't support\")\r\n    }\r\n  }\r\n\r\n  let resolver\r\n  return new Promise(resolve => {\r\n    resolver = resolve\r\n    getDom(\r\n      id,\r\n      el => {\r\n        setTimeout(() => {\r\n          resolver(el)\r\n        })\r\n      },\r\n      type\r\n    )\r\n  })\r\n}\r\n","class ArrayVolume {\r\n  constructor (length) {\r\n    this.queue = length === void 0 ? [] : new Array(length)\r\n  }\r\n  /**\r\n   * 加入一个回调函数到执行队列\r\n   * @param { Function } callback 回调函数\r\n   * @param { number } priority 优先级\r\n   * @returns { Function } remove函数 从队列中移除回调\r\n   */\r\n  push (callback, priority = 0) {\r\n    if (priority === 0) {\r\n      this.queue.push(callback)\r\n    }\r\n    if (priority === 1) {\r\n      this.queue.unshift(callback)\r\n    }\r\n    return () =>\r\n      this.queue.splice(\r\n        this.queue.findIndex(fn => fn === callback),\r\n        1\r\n      )\r\n  }\r\n}\r\n\r\n/**\r\n * @template T\r\n */\r\nexport class ChainRunner extends ArrayVolume {\r\n  constructor () {\r\n    super()\r\n  }\r\n  /**\r\n   * @description 加入一个回调函数到执行队列\r\n   * @param { IGenericFunction<T,T> } callback 回调函数\r\n   * @param { number } [priority=1] 优先级\r\n   * @returns { cancelCallback } remove函数 从队列中移除回调\r\n   */\r\n  push (callback, priority = 1) {\r\n    return super.push(callback, priority)\r\n  }\r\n  /**\r\n   * @description 加入一个回调函数到执行队列\r\n   * @param { IGenericFunction<T,T> } callback 回调函数\r\n   * @returns { cancelCallback } remove函数 从队列中移除回调\r\n   */\r\n  use (callback) {\r\n    return this.push(callback)\r\n  }\r\n  /**\r\n   * @description 链式执行回调队列中的回调函数\r\n   * @param  {*} result 执行参数\r\n   * @returns {T}\r\n   */\r\n  run (result) {\r\n    let res = result\r\n    for (const fn of this.queue) {\r\n      res = fn(res)\r\n    }\r\n    return res\r\n  }\r\n}\r\n","/**\r\n * @description 获取URL search参数\r\n * @param {Location} location\r\n * @returns {object}\r\n */\r\nexport function getParams (location) {\r\n  const search = location.search.slice(1)\r\n  const result = {}\r\n  search\r\n    .split('&')\r\n    .map(p => p.split('='))\r\n    .forEach(item => {\r\n      result[item[0]] = item[1]\r\n    })\r\n  return result\r\n}\r\n","const _toString = Object.prototype.toString\r\n\r\nexport function isObject (t) {\r\n  return _toString.call(t) === '[object Object]'\r\n}\r\n","export * from './onEvent'\r\nexport * from './requestDom'\r\nexport * from './volume'\r\nexport * from './getParams'\r\nexport * from './validator'\r\n\r\nexport function toObj (t) {\r\n  return Object.assign({}, t)\r\n}\r\n","const randomUUID = typeof crypto !== 'undefined' && crypto.randomUUID && crypto.randomUUID.bind(crypto);\nexport default {\n  randomUUID\n};","// Unique ID creation requires a high quality random # generator. In the browser we therefore\n// require the crypto API and do not support built-in fallback to lower quality random number\n// generators (like Math.random()).\nlet getRandomValues;\nconst rnds8 = new Uint8Array(16);\nexport default function rng() {\n  // lazy load so that environments that need to polyfill have a chance to do so\n  if (!getRandomValues) {\n    // getRandomValues needs to be invoked in a context where \"this\" is a Crypto implementation.\n    getRandomValues = typeof crypto !== 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto);\n\n    if (!getRandomValues) {\n      throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n    }\n  }\n\n  return getRandomValues(rnds8);\n}","import validate from './validate.js';\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\n\nconst byteToHex = [];\n\nfor (let i = 0; i < 256; ++i) {\n  byteToHex.push((i + 0x100).toString(16).slice(1));\n}\n\nexport function unsafeStringify(arr, offset = 0) {\n  // Note: Be careful editing this code!  It's been tuned for performance\n  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\n  return (byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]]).toLowerCase();\n}\n\nfunction stringify(arr, offset = 0) {\n  const uuid = unsafeStringify(arr, offset); // Consistency check for valid UUID.  If this throws, it's likely due to one\n  // of the following:\n  // - One or more input array values don't map to a hex octet (leading to\n  // \"undefined\" in the uuid)\n  // - Invalid input values for the RFC `version` or `variant` fields\n\n  if (!validate(uuid)) {\n    throw TypeError('Stringified UUID is invalid');\n  }\n\n  return uuid;\n}\n\nexport default stringify;","import native from './native.js';\nimport rng from './rng.js';\nimport { unsafeStringify } from './stringify.js';\n\nfunction v4(options, buf, offset) {\n  if (native.randomUUID && !buf && !options) {\n    return native.randomUUID();\n  }\n\n  options = options || {};\n  const rnds = options.random || (options.rng || rng)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    offset = offset || 0;\n\n    for (let i = 0; i < 16; ++i) {\n      buf[offset + i] = rnds[i];\n    }\n\n    return buf;\n  }\n\n  return unsafeStringify(rnds);\n}\n\nexport default v4;","import { v4 as uuidv4 } from 'uuid'\r\nimport { ChainRunner, onMessage, isObject, toObj } from '../util'\r\n\r\n/**\r\n * @description Message类只提供发送消息和接受消息的方法，只确保发送的消息属于当前命名空间\r\n * @class\r\n */\r\nexport class Message {\r\n  /**\r\n   * @description 初始化一个Channel\r\n   * @constructor\r\n   * @param {Window | WindowContent} targetWindow\r\n   * @param {MessageOpts} options Channel初始化options\r\n   */\r\n  constructor (targetWindow, options = {}) {\r\n    this.appCode = ''\r\n    this.targetOrigin = options.targetOrigin || '*'\r\n    this.timeout = options.timeout || 3 * 1000\r\n    this.belong = options.namespace || 'gislife'\r\n    /**@description 请求拦截器 */\r\n    /**@type ChainRunner<IPostMessageSyntax<*>> */\r\n    this.requestInterceptor = new ChainRunner()\r\n  }\r\n  /**\r\n   * todo 包裹原生消息发生函数，保证消息唯一性,局部性;\r\n   * @description 发送消息\r\n   * @param {(IMessage<*>&IPostMessageSyntax<*>) | IPostMessageSyntax<*>} msg\r\n   * @param {HTMLIFrameElement.contentWindow} target\r\n   * @returns { Promise<IMessage<*> & IPostMessageSyntax<*>> }\r\n   */\r\n  _postMessage (msg, target) {\r\n    const timeout = msg.timeout || this.timeout\r\n    let isSendOK = false\r\n    const id = uuidv4()\r\n    if (target) {\r\n      let sendRes\r\n      if (msg && msg.id) {\r\n        sendRes = Object.assign(msg, { belong: this.belong })\r\n      } else {\r\n        /** @type IPostMessageSyntax<*> */\r\n        const res = this.requestInterceptor.run(msg)\r\n        sendRes = Object.assign({ id, belong: this.belong }, res)\r\n      }\r\n      return new Promise((resolve, reject) => {\r\n        console.log(\r\n          `_postmessage from ${this.appCode} to ${sendRes.target}`,\r\n          sendRes\r\n        )\r\n        target.postMessage(sendRes, '*')\r\n        const cancel = this.__on(data => {\r\n          if (isObject(data) && data.id === id && data.belong === this.belong) {\r\n            isSendOK = true\r\n            cancel()\r\n            console.log('______________postMessage callback', data)\r\n            resolve(data)\r\n          }\r\n        })\r\n        setTimeout(() => {\r\n          if (!isSendOK) {\r\n            cancel()\r\n            console.warn('message missing response or response timeout !!!!!!!')\r\n            reject(msg)\r\n          }\r\n        }, timeout)\r\n      })\r\n    } else {\r\n      throw Error(\r\n        `_postmessage target not exist named ${\r\n          msg.target || msg.data.target\r\n        }, message type is ${msg.type}, source is ${this.appCode}`\r\n      )\r\n    }\r\n  }\r\n\r\n  /**\r\n   * todo 发送消息\r\n   * @description 发送消息\r\n   * @param {Window} target\r\n   * @param {(IMessage<*>&IPostMessageSyntax<*>) | IPostMessageSyntax<*>} msg 消息体\r\n   * @returns { Promise<IMessage<*> & IPostMessageSyntax<*>> } 回复的消息\r\n   */\r\n  __send (target, msg) {\r\n    return this._postMessage(msg, target).then(\r\n      res => {\r\n        console.log('______________send callback', res)\r\n        return res\r\n      },\r\n      err => {\r\n        return Promise.reject(err)\r\n      }\r\n    )\r\n  }\r\n  /**\r\n   * @description 监听消息 只监听当前命名空间的消息,且非回复消息\r\n   * @param {IGenericFunction<IMessage<*>&IPostMessageSyntax<*>,void>} cb 接收到消息的回调函数\r\n   * @returns {cancelCallback} 取消监听事件的函数\r\n   */\r\n  __on (cb) {\r\n    return onMessage(event => {\r\n      if (isObject(event.data) && event.data.belong === this.belong) {\r\n        console.warn(\r\n          `before on from ${event.data.sourceCode} to ${event.data.target},current is ${this.appCode}`,\r\n          event.data\r\n        )\r\n        cb(event.data)\r\n      }\r\n    })\r\n  }\r\n}\r\n","import { Message } from './Message'\r\nimport { isObject, getParams } from '../util'\r\n\r\n/**@type {Map<microAppCode,microAppContext>} */\r\nconst microAppMap = new Map()\r\n\r\n/**\r\n * @typedef {Map<microAppContext,object>} IStateMap\r\n * @description 组件状态Map\r\n * @type {IStateMap}\r\n */\r\nconst stateMap = new Map()\r\n\r\nexport { microAppMap, stateMap }\r\n/**\r\n * @class Channel\r\n */\r\nexport class Channel extends Message {\r\n  /**\r\n   * @description 新建一个目标连接频道\r\n   * @constructor\r\n   * @param { Window | windowContent} target 目标上下文\r\n   * @param {ChannelOpts} options 其它参数\r\n   */\r\n  constructor (target, options = {}) {\r\n    super(target, options)\r\n    //*消息转发\r\n    this._passive()\r\n    //*维护注册表\r\n    this._maintainRegister()\r\n  }\r\n\r\n  /**\r\n   * !消息派发的主要逻辑\r\n   * todo 如果消息没有target 默认target为 main\r\n   * @description 为每条消息带上popSource\r\n   * @param {?Window} target\r\n   * @param {(IMessage<*>&IPostMessageSyntax<*>) | IPostMessageSyntax<*>} msg\r\n   * @returns {Promise<IPostMessageSyntax<T>>}\r\n   */\r\n  send (target, msg) {\r\n    msg.sourceCode =\r\n      msg.sourceCode === undefined ? this.appCode : msg.sourceCode\r\n    msg.pop = msg.pop === undefined ? true : msg.pop\r\n\r\n    if (target) {\r\n      return super.__send(target, msg)\r\n    } else {\r\n      //todo 如果target不存在，则向全局发送消息\r\n      const sendTargets = []\r\n      if (window.parent !== window && msg.pop === true) {\r\n        super.__send(window.parent, msg)\r\n      }\r\n      microAppMap.forEach((value, key) => {\r\n        const data = msg\r\n        data.pop = false\r\n        super.__send(value.contentWindow, data)\r\n      })\r\n      return Promise.resolve(undefined)\r\n    }\r\n  }\r\n  /**\r\n   * todo 响应自己的消息，如果不是自己的消息则传递消息\r\n   * @description 监听消息，并在自动取消监听\r\n   * @param {IGenericFunction<IMessage<*>&IPostMessageSyntax<*>,void>} cb 监听到消息的回调函数\r\n   * @param { Vue.Component } context 组件上下文\r\n   * @returns {cancelCallback} 取消监听的回调函数\r\n   */\r\n  on (cb) {\r\n    return super.__on(res => {\r\n      // todo 如果消息的目标是当前目标或者为'parent'，则直接响应消息\r\n      if (\r\n        res.target === this.appCode ||\r\n        res.target === 'global' ||\r\n        res.target === 'parent'\r\n      ) {\r\n        cb(res)\r\n      }\r\n    })\r\n  }\r\n\r\n  /**\r\n   * !应用注册的主要逻辑\r\n   * @description 设置当前应用的AppCode\r\n   * @param {string} val\r\n   * @returns {void}\r\n   */\r\n  setAppCode (val) {\r\n    this.appCode = val\r\n    // todo 当前应用不是子应用，则向主应用注册\r\n    // todo 自动向父级注册\r\n    if (window.parent !== window) {\r\n      this.send(window.parent, {\r\n        target: 'parent',\r\n        type: 'register',\r\n        sourceCode: this.appCode,\r\n        pop: false\r\n      })\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @description 取消注册子应用\r\n   * @param {string} appCode 子应用Code\r\n   */\r\n  unRegisterApp (appCode) {\r\n    return microAppMap.delete(appCode)\r\n  }\r\n  /**\r\n   * @typedef {[string,HTMLIFrameElement] } targetLike\r\n   * @param {targetLike | undefined} target\r\n   */\r\n  getApp (target) {\r\n    return microAppMap.get(target)\r\n  }\r\n  /**\r\n   * @description 注册子应用\r\n   * @param {string} appCode 子应用Code\r\n   * @param {HTMLIFrameElement} target 子应用Iframe元素\r\n   */\r\n  registerApp (appCode, target) {\r\n    microAppMap.set(appCode, target)\r\n  }\r\n\r\n  /**\r\n   * @param {microAppCode} microAppCode\r\n   * @returns {object | undefined}\r\n   */\r\n  getState (microAppCode) {\r\n    return stateMap.get(microAppCode)\r\n  }\r\n  /**\r\n   *\r\n   * @param {microAppCode} microAppCode\r\n   * @param {object} state\r\n   * @returns {IStateMap}\r\n   */\r\n  setState (microAppCode, state) {\r\n    return stateMap.set(microAppCode, state)\r\n  }\r\n\r\n  /**\r\n   * @description 消息传递\r\n   * @returns\r\n   */\r\n  _passive () {\r\n    return super.__on(msg => {\r\n      // todo 传递消息\r\n      if (\r\n        msg.target !== this.appCode &&\r\n        msg.target !== 'parent' &&\r\n        msg.type !== 'state'\r\n      ) {\r\n        // todo main\r\n        if (msg.target === 'main' && window.parent !== window) {\r\n          this.send(window.parent, msg)\r\n          return\r\n        }\r\n        if (msg.target === 'global' || msg.target !== this.appCode) {\r\n          //! 如果传递到根节点还未找到\r\n          if (this.appCode === 'main') msg.pop = false\r\n          // todo sibling\r\n          microAppMap.forEach((tar, tarCode) => {\r\n            if (tarCode !== msg.sourceCode) {\r\n              this.send(tar.contentWindow, Object.assign(msg, { pop: false }))\r\n            }\r\n          })\r\n          //todo parent\r\n          if (window.parent !== window && msg.pop === true) {\r\n            this.send(window.parent, Object.assign(msg, { pop: true }))\r\n          }\r\n        }\r\n      }\r\n    })\r\n  }\r\n  /**\r\n   * @description 默认注册事件\r\n   * @returns\r\n   */\r\n  _maintainRegister () {\r\n    return this.on(msg => {\r\n      const microAppCode = msg.sourceCode\r\n      if (msg.type === 'register' && msg.target === 'parent') {\r\n        //todo 注册\r\n        const el = document.getElementById('gislife-' + microAppCode)\r\n        if (el) {\r\n          this.registerApp(microAppCode, el)\r\n        } else {\r\n          throw Error(\r\n            `register error, can not find element named ${microAppCode}}`\r\n          )\r\n        }\r\n      }\r\n    })\r\n  }\r\n  /**\r\n   * @description 是否是主应用\r\n   * @returns {boolean}\r\n   */\r\n  isMain () {\r\n    return this.appCode === 'main'\r\n  }\r\n}\r\n","import { Channel, stateMap } from './core/Channel'\r\nimport { v4 as uuidv4 } from 'uuid'\r\nimport { isObject, getParams } from './util'\r\n\r\n/**\r\n * @class ApplicationChannel\r\n */\r\nexport class ApplicationChannel extends Channel {\r\n  /**\r\n   * @description 新建一个目标连接频道\r\n   * @constructor\r\n   * @param { window | windowContent} target 目标上下文\r\n   * @param {ChannelOpts} options 其它参数\r\n   */\r\n  constructor (target, options) {\r\n    super(target, options)\r\n    this.DEFAULT_GLOBAL_CONFIG = options.configField || 'URL_CONFIG'\r\n    //*默认事件一\r\n    this._stateResponse()\r\n    if (window === window.parent) {\r\n      this._configResponse()\r\n    }\r\n  }\r\n  /**\r\n   * @description 处理多条件参数\r\n   * @param {IPostMessageSyntax<*> | (IPostMessageSyntax<*> & IMessage<*>)} msg\r\n   * @returns {Promise<IPostMessageSyntax<*> & IMessage<*>>}\r\n   */\r\n  $send (msg) {\r\n    let target\r\n    if (!msg.target || !msg.type) throw Error('message syntax error')\r\n    //todo main parent发送\r\n    if (msg.target === 'main' || msg.target === 'parent') {\r\n      if (window.parent === window && msg.target === 'main') {\r\n        throw Error('can not send message to myself')\r\n      }\r\n      return super.send(window.parent, msg)\r\n    } else {\r\n      const targetEl = this.getApp(msg.target)\r\n      if (!targetEl) {\r\n        console.warn(\r\n          `current layer target not exist target named ${msg.target}`\r\n        )\r\n      } else {\r\n        target = targetEl.contentWindow\r\n      }\r\n      return super.send(target, msg)\r\n    }\r\n  }\r\n  /**\r\n   * @param {Vue.Component} context\r\n   * @param {PostMessageType | IGenericFunction<{data:IMessage<IPostMessageSyntax<IUserData>>,responser:function},any>} type\r\n   * @param {IGenericFunction<IPostMessageSyntax<IUserData>,any> | IGenericFunction<IUserData,any>} cb\r\n   */\r\n  $on (context, type, cb) {\r\n    let onCancel\r\n    if (cb && typeof cb !== 'function') {\r\n      throw Error(`$on callback param error,current type is ${typeof cb}`)\r\n    }\r\n    if (typeof type !== 'string' && typeof type !== 'function') {\r\n      throw Error('type parma type error')\r\n    }\r\n    if (context) {\r\n      context.$on('hook:beforeDestory', () => {\r\n        onCancel?.()\r\n      })\r\n    }\r\n    if (typeof type === 'function') {\r\n      onCancel = super.on(msg => {\r\n        const responser = this._getResponse(msg)\r\n        type({ data: msg, responser })\r\n      })\r\n      return onCancel\r\n    } else {\r\n      onCancel = super.on(msg => {\r\n        if (msg.type === type) {\r\n          const responser = this._getResponse(msg)\r\n          cb({ data: msg.data, responser })\r\n        }\r\n      })\r\n    }\r\n    return onCancel\r\n  }\r\n\r\n  /**\r\n   * @description 发送回调消息\r\n   * @param { string } target 目标应用CODE\r\n   * @param { function } cb 回调函数\r\n   * @param { object | null} params 回调函数参数\r\n   * @returns { promise }\r\n   */\r\n  sendCallback (target, cb, params) {\r\n    if (typeof cb !== 'function' || params === undefined) {\r\n      throw Error('callback or params type error')\r\n    }\r\n    if (!target) {\r\n      throw Error('missing target')\r\n    }\r\n    return this.$send({\r\n      type: 'callback',\r\n      target: target,\r\n      data: {\r\n        callback: cb.toString(),\r\n        params: params\r\n      }\r\n    })\r\n  }\r\n  /**\r\n   * @description 接收消息\r\n   * @param {IGenericFunction<Function,any>} cb 接收消息的回调函数\r\n   * @param { Vue.Component } context 组件上下文\r\n   * @returns {cancelCallback} 取消回调的函数\r\n   */\r\n  onCallback (context, cb) {\r\n    if (typeof cb !== 'function') {\r\n      throw Error(\r\n        `onCallback callback param error,current type is ${typeof cb}`\r\n      )\r\n    }\r\n    const onCancel = this.on(msg => {\r\n      if (msg.type === 'callback') {\r\n        const data = msg.data\r\n        if (data.params !== null) {\r\n          const paramsName = Object.keys(data.params)\r\n          const paramsValue = Object.values(data.params)\r\n          const func = Function(\r\n            ...paramsName,\r\n            `(${data.callback})(${paramsName.join(',')})`\r\n          )\r\n          cb({\r\n            exec: function (ctx) {\r\n              func.apply(ctx, paramsValue)\r\n            },\r\n            responser\r\n          })\r\n        } else {\r\n          const func = Function(`(${data.callback})()`)\r\n          cb({\r\n            exec: function (ctx) {\r\n              func.apply(ctx)\r\n            },\r\n            responser\r\n          })\r\n        }\r\n      }\r\n    })\r\n    if (context) {\r\n      context.$on('hook:beforeDestory', onCancel)\r\n    }\r\n    return onCancel\r\n  }\r\n\r\n  /**\r\n   * @description 获取主应用全局配置\r\n   * @returns {Promise<object>}\r\n   */\r\n  getConfig (options = {}) {\r\n    const { timeout = 3 * 1000 } = options\r\n    let sendOk = false\r\n    return new Promise((resolve, reject) => {\r\n      const id = uuidv4()\r\n      this.$send({\r\n        target: 'main',\r\n        type: 'config',\r\n        id: id\r\n      })\r\n      const cancel = this.$on(undefined, ({ data }) => {\r\n        if (isObject(data) && data.id === id) {\r\n          cancel()\r\n          sendOk = true\r\n          resolve(data.data)\r\n        }\r\n      })\r\n      setTimeout(() => {\r\n        if (!sendOk) {\r\n          reject('getConfig error')\r\n          cancel()\r\n        }\r\n      }, timeout)\r\n    })\r\n  }\r\n  /**\r\n   * @description 发送配置，只能以code方式发送，为了避免子应用未注册造成的消息丢失\r\n   * @param {string} microAppCode\r\n   * @param {object} state\r\n   */\r\n  sendState (microAppCode, state) {\r\n    this.setState(microAppCode, state)\r\n    return this.$send({\r\n      target: microAppCode,\r\n      type: 'state',\r\n      data: state\r\n    })\r\n  }\r\n  /**\r\n   * @description 接收消息 T为消息的具体格式\r\n   * @template T\r\n   * @param {IGenericFunction<T,any>} cb 接收消息的回调函数\r\n   * @param { Vue.Component } context 组件上下文\r\n   * @returns {cancelCallback} 取消回调的函数\r\n   */\r\n  onState (context, cb) {\r\n    if (typeof cb !== 'function') {\r\n      throw Error(`onState callback param error,current type is ${typeof cb}`)\r\n    }\r\n    this.$send({\r\n      target: 'parent',\r\n      type: 'getState'\r\n    }).then(res => {\r\n      cb(res.data)\r\n    })\r\n    return this.$on(context, res => {\r\n      console.log('onState on0----------------------', res)\r\n      if (res.data.type === 'state') {\r\n        cb(res.data.data)\r\n      }\r\n    })\r\n  }\r\n  /**\r\n   * @param {IMessage<*>&IPostMessageSyntax<*>} msg\r\n   * @returns {IGenericFunction<IMessage<IPostMessageSyntax<*>>,IMessage<IPostMessageSyntax<*>>>}\r\n   */\r\n  _getResponse (msg) {\r\n    return data => {\r\n      msg.target = msg.sourceCode\r\n      msg.sourceCode = this.appCode\r\n      return this.$send(Object.assign(msg, { data: data }))\r\n    }\r\n  }\r\n  /**\r\n   * @description 全局配置响应,\r\n   * @param {Channel} context\r\n   */\r\n  _configResponse () {\r\n    return this.on(msg => {\r\n      if (msg.type === 'config') {\r\n        msg.data = window[this.DEFAULT_GLOBAL_CONFIG]\r\n        msg.target = msg.sourceCode\r\n        msg.sourceCode = this.appCode\r\n        msg.pop = false //从主应用向下发消息，禁止冒泡\r\n        this.$send(msg)\r\n      }\r\n    })\r\n  }\r\n  /**\r\n   * @description 响应'getState'事件\r\n   * @param {Channel} context\r\n   */\r\n  _stateResponse () {\r\n    return super.on(msg => {\r\n      if (msg.target === 'parent' && msg.type === 'getState') {\r\n        msg.target = msg.sourceCode\r\n        msg.sourceCode = this.appCode\r\n        msg.data = stateMap.get(msg.sourceCode)\r\n        msg.type = 'state'\r\n        console.log('getState-------------------', msg)\r\n        this.$send(msg)\r\n      }\r\n    })\r\n  }\r\n  /**\r\n   * @description main\r\n   * @param {Channel} instance\r\n   */\r\n  applicationBootstrap () {\r\n    if (window.parent !== window) {\r\n      // TODO 获取子应用AppCode\r\n      /**@type ParamsType */\r\n      const params = getParams(window.location)\r\n      // ! 子应用\r\n      this.setAppCode(params.microAppCode)\r\n    } else {\r\n      // ! 主应用\r\n      this.setAppCode('main')\r\n    }\r\n  }\r\n  /**\r\n   * @description AppCode\r\n   * @returns {string} microAppCode\r\n   */\r\n  getMicroAppCode () {\r\n    return this.appCode\r\n  }\r\n  /**\r\n   *\r\n   * @param {string} key\r\n   */\r\n  setGlobalConfigField (key) {\r\n    if (key) this.DEFAULT_GLOBAL_CONFIG = key\r\n  }\r\n}\r\n","<template>\r\n\t<iframe\r\n\t\t:title=\"id\"\r\n\t\t:src=\"buildSrc(src)\"\r\n\t\t:id=\"id\"\r\n\t\tclass=\"gislife-micro-app\"\r\n\t\t:class=\"classNmae\"\r\n\t\tref=\"window\"\r\n\t>\r\n\t</iframe>\r\n</template>\r\n\r\n<script>\r\nimport { requestDom } from './util'\r\n\r\nexport default {\r\n\tname: \"microApp\",\r\n\tinheritAttrs: false,\r\n\tprops: {\r\n\t\tsrc: {\r\n\t\t\ttype: String,\r\n\t\t\trequired: true\r\n\t\t},\r\n\t\tmicroAppCode: {\r\n\t\t\ttype: String,\r\n\t\t\trequired: true,\r\n\t\t},\r\n\t\tstate: {\r\n\t\t\ttype: Object,\r\n\t\t},\r\n\t\tclassNmae: String\r\n\t},\r\n\tdata () {\r\n\t\treturn {\r\n\t\t\tid: 'gislife-' + this.microAppCode,\r\n\t\t};\r\n\t},\r\n\twatch: {\r\n\t\tstate: {\r\n\t\t\tdeep: true,\r\n\t\t\timmediate: true,\r\n\t\t\tasync handler (val) {\r\n\t\t\t\tawait requestDom(this.id,(el) => el && el.contentWindow)\r\n\t\t\t\t/**@type ConnectChannel */\r\n\t\t\t\tconst connector = this.$connector;\r\n\t\t\t\tconnector.sendState(this.microAppCode,val)\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tcreated () {\r\n\t\t// this.$connector.register(this.$connector)\r\n\t},\r\n\tdestroyed () {\r\n\t\tthis.$connector.unRegisterApp(this.microAppCode)\r\n\t},\r\n\tmethods: {\r\n\t\tbuildSrc (src) {\r\n\t\t\tconst hasParam = src.includes('?');\r\n\t\t\treturn src + (hasParam ? '&' : '?') + 'microAppCode=' + this.microAppCode\r\n\t\t}\r\n\t}\r\n}\r\n</script>\r\n\r\n<style lang=\"css\">\r\n.gislife-micro-app {\r\n\twidth: 100%;\r\n\theight: 100%;\r\n}\r\n</style>\r\n","import mod from \"-!../node_modules/babel-loader/lib/index.js!../node_modules/vue-loader/lib/index.js??vue-loader-options!./microApp.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/babel-loader/lib/index.js!../node_modules/vue-loader/lib/index.js??vue-loader-options!./microApp.vue?vue&type=script&lang=js&\"","\n      import API from \"!../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-2.use[1]!../node_modules/css-loader/dist/cjs.js!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-2.use[3]!../node_modules/vue-loader/lib/index.js??vue-loader-options!./microApp.vue?vue&type=style&index=0&id=0b0bfc7c&prod&lang=css&\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-2.use[1]!../node_modules/css-loader/dist/cjs.js!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-2.use[3]!../node_modules/vue-loader/lib/index.js??vue-loader-options!./microApp.vue?vue&type=style&index=0&id=0b0bfc7c&prod&lang=css&\";\n       export default content && content.locals ? content.locals : undefined;\n","import { render, staticRenderFns } from \"./microApp.vue?vue&type=template&id=0b0bfc7c&\"\nimport script from \"./microApp.vue?vue&type=script&lang=js&\"\nexport * from \"./microApp.vue?vue&type=script&lang=js&\"\nimport style0 from \"./microApp.vue?vue&type=style&index=0&id=0b0bfc7c&prod&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","/* globals __VUE_SSR_CONTEXT__ */\n\n// IMPORTANT: Do NOT use ES2015 features in this file (except for modules).\n// This module is a runtime utility for cleaner component module output and will\n// be included in the final webpack user bundle.\n\nexport default function normalizeComponent(\n  scriptExports,\n  render,\n  staticRenderFns,\n  functionalTemplate,\n  injectStyles,\n  scopeId,\n  moduleIdentifier /* server only */,\n  shadowMode /* vue-cli only */\n) {\n  // Vue.extend constructor export interop\n  var options =\n    typeof scriptExports === 'function' ? scriptExports.options : scriptExports\n\n  // render functions\n  if (render) {\n    options.render = render\n    options.staticRenderFns = staticRenderFns\n    options._compiled = true\n  }\n\n  // functional template\n  if (functionalTemplate) {\n    options.functional = true\n  }\n\n  // scopedId\n  if (scopeId) {\n    options._scopeId = 'data-v-' + scopeId\n  }\n\n  var hook\n  if (moduleIdentifier) {\n    // server build\n    hook = function (context) {\n      // 2.3 injection\n      context =\n        context || // cached call\n        (this.$vnode && this.$vnode.ssrContext) || // stateful\n        (this.parent && this.parent.$vnode && this.parent.$vnode.ssrContext) // functional\n      // 2.2 with runInNewContext: true\n      if (!context && typeof __VUE_SSR_CONTEXT__ !== 'undefined') {\n        context = __VUE_SSR_CONTEXT__\n      }\n      // inject component styles\n      if (injectStyles) {\n        injectStyles.call(this, context)\n      }\n      // register component module identifier for async chunk inferrence\n      if (context && context._registeredComponents) {\n        context._registeredComponents.add(moduleIdentifier)\n      }\n    }\n    // used by ssr in case component is cached and beforeCreate\n    // never gets called\n    options._ssrRegister = hook\n  } else if (injectStyles) {\n    hook = shadowMode\n      ? function () {\n          injectStyles.call(\n            this,\n            (options.functional ? this.parent : this).$root.$options.shadowRoot\n          )\n        }\n      : injectStyles\n  }\n\n  if (hook) {\n    if (options.functional) {\n      // for template-only hot-reload because in that case the render fn doesn't\n      // go through the normalizer\n      options._injectStyles = hook\n      // register for functional component in vue file\n      var originalRender = options.render\n      options.render = function renderWithStyleInjection(h, context) {\n        hook.call(context)\n        return originalRender(h, context)\n      }\n    } else {\n      // inject component registration as beforeCreate hook\n      var existing = options.beforeCreate\n      options.beforeCreate = existing ? [].concat(existing, hook) : [hook]\n    }\n  }\n\n  return {\n    exports: scriptExports,\n    options: options\n  }\n}\n","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('iframe',{ref:\"window\",staticClass:\"gislife-micro-app\",class:_vm.classNmae,attrs:{\"title\":_vm.id,\"src\":_vm.buildSrc(_vm.src),\"id\":_vm.id}})\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","/**\r\n * @author dengtao\r\n */\r\nimport * as Utils from './util'\r\nimport { ApplicationChannel } from './ApplicationChannel'\r\nimport microAppVue from './microApp.vue'\r\n\r\n/**\r\n * @typedef ParamsType\r\n * @type {object}\r\n * @property {string} appCode\r\n * @property {string} microAppCode\r\n */\r\nconst connector = new ApplicationChannel()\r\n\r\nexport { Utils, connector }\r\n\r\nexport default {\r\n  install (vue, options) {\r\n    if (options.configKey) {\r\n      connector.setGlobalConfigField(configKey)\r\n    }\r\n    connector.applicationBootstrap()\r\n    Object.defineProperty(vue.prototype, '$connector', {\r\n      get () {\r\n        return connector\r\n      },\r\n      set (v) {\r\n        throw Error(\"$connector can't set value\")\r\n      }\r\n    })\r\n    vue.component(microAppVue.name, microAppVue)\r\n  }\r\n}\r\n"],"names":["root","factory","exports","module","define","amd","self","stylesInDOM","getIndexByIdentifier","identifier","result","i","length","modulesToDom","list","options","idCountMap","identifiers","item","id","base","count","concat","indexByIdentifier","obj","css","media","sourceMap","supports","layer","references","updater","addElementStyle","byIndex","splice","push","api","domAPI","update","newObj","remove","lastIdentifiers","newList","index","newLastIdentifiers","_i","_index","memo","insert","style","target","styleTarget","document","querySelector","window","HTMLIFrameElement","contentDocument","head","e","getTarget","Error","appendChild","element","createElement","setAttributes","attributes","styleElement","nonce","setAttribute","insertStyleElement","needLayer","btoa","unescape","encodeURIComponent","JSON","stringify","styleTagTransform","apply","parentNode","removeChild","removeStyleElement","styleSheet","cssText","firstChild","createTextNode","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","n","getter","__esModule","d","a","definition","key","o","Object","defineProperty","enumerable","get","prop","prototype","hasOwnProperty","call","r","Symbol","toStringTag","value","nc","onPageHide","cb","addEventListener","removeEventListener","onLoad","onMessage","requestDom","resolver","judgeCb","arguments","el","Boolean","type","getDom","callback","requestAnimationFrame","getElementById","setTimeout","Promise","resolve","ChainRunner","_ArrayVolume","_inherits","_super","_classCallCheck","_createClass","priority","_get","_getPrototypeOf","this","_step","res","_iterator","_createForOfIteratorHelper","queue","s","done","fn","err","f","ArrayVolume","Array","_this","unshift","findIndex","getParams","location","search","slice","split","map","p","forEach","_toString","toString","isObject","t","toObj","assign","randomUUID","crypto","bind","getRandomValues","rnds8","Uint8Array","rng","byteToHex","buf","offset","rnds","random","arr","toLowerCase","unsafeStringify","Message","targetWindow","appCode","targetOrigin","timeout","belong","namespace","requestInterceptor","msg","isSendOK","uuidv4","sendRes","run","reject","postMessage","cancel","__on","data","console","warn","_postMessage","then","_this2","event","sourceCode","microAppMap","Map","stateMap","Channel","_Message","_passive","_maintainRegister","pop","parent","contentWindow","_this3","val","send","set","microAppCode","state","_this4","tar","tarCode","_this5","on","registerApp","ApplicationChannel","_Channel","DEFAULT_GLOBAL_CONFIG","configField","_stateResponse","_configResponse","targetEl","getApp","context","onCancel","_typeof","$on","_onCancel","responser","_getResponse","params","$send","paramsName","keys","paramsValue","values","func","Function","join","exec","ctx","_options$timeout","sendOk","_ref","setState","_this6","setAppCode","_regeneratorRuntime","Op","hasOwn","desc","$Symbol","iteratorSymbol","iterator","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","configurable","writable","wrap","innerFn","outerFn","tryLocsList","protoGenerator","Generator","generator","create","Context","makeInvokeMethod","tryCatch","arg","ContinueSentinel","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","getProto","getPrototypeOf","NativeIteratorPrototype","Gp","defineIteratorMethods","method","_invoke","AsyncIterator","PromiseImpl","invoke","record","__await","unwrapped","error","previousPromise","callInvokeWithMethodAndArg","delegate","delegateResult","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","methodName","TypeError","info","resultName","next","nextLoc","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","resetTryEntry","completion","reset","iterable","iteratorMethod","isNaN","doneResult","displayName","isGeneratorFunction","genFun","ctor","constructor","name","mark","setPrototypeOf","__proto__","awrap","async","iter","object","reverse","skipTempReset","prev","charAt","stop","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","thrown","delegateYield","asyncGeneratorStep","gen","_next","_throw","inheritAttrs","props","src","String","required","classNmae","watch","deep","immediate","handler","_callee","_context","$connector","sendState","args","created","destroyed","unRegisterApp","methods","buildSrc","hasParam","includes","component","scriptExports","render","staticRenderFns","functionalTemplate","injectStyles","scopeId","moduleIdentifier","shadowMode","hook","_compiled","functional","_injectStyles","originalRender","h","existing","beforeCreate","_vm","_c","_self","ref","staticClass","class","attrs","connector","install","vue","configKey","setGlobalConfigField","applicationBootstrap","v","microAppVue"],"sourceRoot":""}